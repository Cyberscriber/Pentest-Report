<h1>Pentest Report</h1>



<h2>Description</h2>
Project consists of Compiling comprehensive findings into a detailed report for organizational leadership of MegaCorpOne, emphasizing strategic security recommendations as employee of fictional Security Company, SecureWrx LLC
<br />


<h2>Confidentiality Statement</h2>
    This document contains confidential and privileged information from MegaCorpOne Inc. (henceforth known as MegaCorpOne). The information contained in this document is confidential and may constitute inside or non-public information under international, federal, or state laws. Unauthorized forwarding, printing, copying, distribution, or use of such information is strictly prohibited and may be unlawful. If you are not the intended recipient, be aware that any disclosure, copying, or distribution of this document or its parts is prohibited.
<br />
<br />


<p align="center">

Table of Contents<br />

Confidentiality Statement	<br />
Contact Information	<br />
Document History	<br />
Introduction	<br />
Assessment Objective	<br />
Penetration Testing Methodology	<br />
Reconnaissance	<br />
Identification of Vulnerabilities and Services	<br />
Vulnerability Exploitation	<br />
Reporting	<br />
Scope	<br />
Executive Summary of Findings	<br />
Grading Methodology	<br />
Summary of Strengths	<br />
Summary of Weaknesses	<br />
Executive Summary Narrative	<br />
Summary Vulnerability Overview	<br />
Vulnerability Findings	<br />
MITRE ATT&CK Navigator Map	<br />
<br />
<br />


<p align="center">
Contact Information: <br/>
<img src="https://imgur.com/UnJBRhw.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br />
Introduction
:  <br/>
  In accordance with MegaCorpOne’s policies, SecureWrx, LLC (henceforth known as SWX) conducts external and internal penetration tests of its networks and systems throughout the year. The purpose of this engagement was to assess the networks’ and systems’ security and identify potential security flaws by utilizing industry-accepted testing methodology and best practices. The project was conducted on a number of systems on MegaCorpOne’s network segments by SWX during April of 2022.
<p align="center">
For the testing, SWX focused on the following:

Attempting to determine what system-level vulnerabilities could be discovered and exploited with no prior knowledge of the environment or notification to administrators.
Attempting to exploit vulnerabilities found and access confidential information that may be stored on systems.
Documenting and reporting on all findings.

All tests took into consideration the actual business processes implemented by the systems and their potential threats; therefore, the results of this assessment reflect a realistic picture of the actual exposure levels to online hackers. This document contains the results of that assessment.
<p align="center">
Assessment Objective

The primary goal of this assessment was to provide an analysis of security flaws present in MegaCorpOne’s web applications, networks, and systems. This assessment was conducted to identify exploitable vulnerabilities and provide actionable recommendations on how to remediate the vulnerabilities to provide a greater level of security for the environment.

SWX used its proven vulnerability testing methodology to assess all relevant web applications, networks, and systems in scope. 

MegaCorpOne has outlined the following objectives:
<p align="center">

<img src="https://imgur.com/t0Kx2kQ.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br />
Penetration Testing Methodology
<p align="center">

Reconnaissance 

SWX begins assessments by checking for any passive (open source) data that may assist the assessors with their tasks. If internal, the assessment team will perform active recon using tools such as Nmap and Bloodhound.

Identification of Vulnerabilities and Services

SWX uses custom, private, and public tools such as Metasploit, hashcat, and Nmap to gain perspective of the network security from a hacker’s point of view. These methods provide MegaCorpOne with an understanding of the risks that threaten its information, and also the strengths and weaknesses of the current controls protecting those systems. The results were achieved by mapping the network architecture, identifying hosts and services, enumerating network and system-level vulnerabilities, attempting to discover unexpected hosts within the environment, and eliminating false positives that might have arisen from scanning. 

Vulnerability Exploitation

SWX’s normal process is to both manually test each identified vulnerability and use automated tools to exploit these issues. Exploitation of a vulnerability is defined as any action we perform that gives us unauthorized access to the system or the sensitive data. 

Reporting

Once exploitation is completed and the assessors have completed their objectives, or have done everything possible within the allotted time, the assessment team writes the report, which is the final deliverable to the customer.

Scope

Prior to any assessment activities, MegaCorpOne and the assessment team will identify targeted systems with a defined range or list of network IP addresses. The assessment team will work directly with the MegaCorpOne POC to determine which network ranges are in-scope for the scheduled assessment. 

It is MegaCorpOne’s responsibility to ensure that IP addresses identified as in-scope are actually controlled by MegaCorpOne and are hosted in MegaCorpOne-owned facilities (i.e., are not hosted by an external organization). In-scope and excluded IP addresses and ranges are listed below.


 <br/>
<img src="https://imgur.com/drRXcQ1.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br />
Executive Summary of Findings

Grading Methodology

Each finding was classified according to its severity, reflecting the risk each such vulnerability may pose to the business processes implemented by the application, based on the following criteria:

Critical:	 Immediate threat to key business processes.
High:		 Indirect threat to key business processes/threat to secondary business processes.
Medium:	 Indirect or partial threat to business processes. 
Low:		 No direct threat exists; vulnerability may be leveraged with other vulnerabilities.
Informational:    No threat; however, it is data that may be used in a future attack.

As the following grid shows, each threat is assessed in terms of both its potential impact on the business and the likelihood of exploitation:
  <br/>
<img src="https://imgur.com/EM5ENPe.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br />
Summary of Strengths

While the assessment team was successful in finding several vulnerabilities, the team also recognized several strengths within MegaCorpOne’s environment. These positives highlight the effective countermeasures and defenses that successfully prevented, detected, or denied an attack technique or tactic from occurring. 

User passwords were hashed
Kerberos and NTLM were both used as authentication types
<br />
<br />
Summary of Weaknesses

SWX successfully found several critical vulnerabilities that should be immediately addressed in order to prevent an adversary from compromising the network. These findings are not specific to a software version but are more general and systemic vulnerabilities.

open port vulnerabilities
weak passwords
outdated or unpatched software application

Executive Summary

Used nmap scan to discover several commonly abused ports that were found to be open, including:  <br/>
Port 53 – DNS. Very often used for amplification DDoS attacks. <br/>
Port 139 – NetBIOS. Legacy protocol primarily used for file and printer sharing. <br/>
Port 80 –  HTTP servers and their various components are very exposed and often sources of attacks. <br/>
Port 445 – SMB. Provides sharing capabilities of files and printers. Used in the 2017 WannaCry attack. <br/>
Port 3306 – SQL Server and MySQL default ports – used for malware distribution. <br/>
https://www.lifars.com/2020/10/are-open-ports-a-security-risk/ <br/>
 <br/>
 <br/>
<img src="https://imgur.com/2uR0Jst.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br />
Persistence established on Windows 10 machine by abusing Task Scheduler:  <br/>
<img src="https://imgur.com/6TJVjRS.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br/>
<img src="https://imgur.com/D6T44ta.png" height="80%" width="80%" alt="Pen test Steps"/>

Lateral Movement WMI exploit shown below from Meterpreter session on Windows 10  to WINDC01
<br/>
<img src="https://imgur.com/AOVXTyF.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br/>

Below screenshots show Meterpreter used to enter a shell.  Users were viewed, then Kiwi was utilized to see the usage
<img src="https://imgur.com/2PfMNhs.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br/>
<img src="https://imgur.com/Ll5KwX4.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br/>
The hashes were placed in a text file, and then run using John the Ripper to crack
<br/>
<img src="https://imgur.com/D5eLL4O.png" height="80%" width="80%" alt="Pen test Steps"/>
<br />
<br/>
</p>
<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
